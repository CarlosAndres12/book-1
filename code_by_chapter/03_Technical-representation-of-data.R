## ------------------------------------------------------------------------
if ( 1 - 0.9 == 0.1 ) print("ok") else print("oh no!")

## ------------------------------------------------------------------------
(1-0.9) - 0.1

## ----eval=FALSE----------------------------------------------------------
## read.table(textConnection("123451234512345")
##   , colClasses="integer")

## ----eval=TRUE-----------------------------------------------------------
max_int <- .Machine$integer.max

## ----eval=FALSE----------------------------------------------------------
## x1 <- 2L * max_int
## x2 <- 2 * max_int

## ------------------------------------------------------------------------
.Machine$integer.max

## ------------------------------------------------------------------------
int_min <- as.integer(-2^31)
one_above_min <- as.integer(-2^{31}+1)

## ------------------------------------------------------------------------
d1 <- read.table(textConnection("1324665248"))
d2 <- read.table(textConnection("4827647632"))

## ----eval=FALSE----------------------------------------------------------
## # bad practice (x and y must be scalar):
## if ( x == y ) {...}
## 
## # good practice (x and y must be scalar):
## if ( abs(x-y) < tol ){...}
## 
## # or, shorter (x and y may be vectors):
## if ( all.equal(x,y) ) {...}

## ----eval=FALSE----------------------------------------------------------
## NA_real_ * NaN
## ## [1] NaN
## NaN * NA_real_
## ## [1] NA

## ------------------------------------------------------------------------
"Just say 'hello'"
'Just say "hello"'

## ------------------------------------------------------------------------
"Just say \"hello\""

## ------------------------------------------------------------------------
c("A", "\101", "\x41")

## ------------------------------------------------------------------------
"Latin small letter 'o' with diaereses: \uf6"

## ------------------------------------------------------------------------
nchar("Motörhead")
nchar("Motörhead", type="bytes")

## ------------------------------------------------------------------------
nchar("FO\ufeffO",type="width")

## ----eval=FALSE----------------------------------------------------------
## Sys.getlocale("LC_CTYPE")
## ## [1] "en_US.UTF-8"

## ----eval=FALSE----------------------------------------------------------
## Sys.getlocale("LC_CTYPE")
## ## [1] "Dutch_Netherlands.1252"

## ------------------------------------------------------------------------
Encoding(c("Motörhead","On Parole"))

## ------------------------------------------------------------------------
s <- "Motörhead"
Encoding(s) <- "latin1"
s

## ------------------------------------------------------------------------
library(stringi)
bytes <- readBin("hr.txt", what="raw",n=200)
stri_enc_detect(bytes)

## ------------------------------------------------------------------------
Sys.getlocale("LC_COLLATE")

## ------------------------------------------------------------------------
library(stringi)
# default sorting: 1 < 2
stri_sort(c("19","2"))
# numeric sorting: 2 < 19
stri_sort(c("19","2"), opts_collator = stri_opts_collator(numeric=TRUE))

## ------------------------------------------------------------------------
t0 <- Sys.time()
t0
# the storage format is unveiled with 'unclass'
unclass(t0)

## ------------------------------------------------------------------------
t0_lt <- as.POSIXlt(t0)
names(unclass(t0_lt))

## ------------------------------------------------------------------------
t0_lt$year

## ------------------------------------------------------------------------
text <- c("2/1/1977", "02-Jan-1977", "It all started on 2 January 1977")
lubridate::dmy(text, locale="en_US.utf8")

## ------------------------------------------------------------------------
text <- "It happened on 02-01/1977, at 05:30 in the morning"
(t <- as.POSIXct(strptime(text, 
  "It happened on %d-%m/%Y, at %H:%M in the morning")))

## ------------------------------------------------------------------------
format(t)
format(t,"%Y-%m-%d",usetz=TRUE)

## ------------------------------------------------------------------------
lubridate::ymd("2011-02-29", quiet=TRUE)
strptime("2011-02-29","%Y-%m-%d")

## ------------------------------------------------------------------------
lubridate::ymd("2014-10-25",tz="Europe/Amsterdam")
as.POSIXct(strptime("2014-10-25","%Y-%m-%d",tz="Europe/Amsterdam"))

## ------------------------------------------------------------------------
as.POSIXct(strptime("2014-10-25 +0100","%Y-%m-%d %z"))

## ------------------------------------------------------------------------
as.integer(as.POSIXct(strptime("2014-12-10 15:00","%Y-%m-%d %H:%M"
  , tz="Europe/London")))
as.integer(as.POSIXct(strptime("2014-12-10 16:00","%Y-%m-%d %H:%M"
  , tz="Europe/Amsterdam")))

## ----eval=FALSE----------------------------------------------------------
## as.POSIXct(strptime("2014-03-30 02:30","%Y-%m-%d %H:%M"
##   , tz="Europe/Madrid"))

## ----eval=FALSE----------------------------------------------------------
## Sys.getlocale("LC_ALL")
## sessionInfo()

